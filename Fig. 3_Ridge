
#The code below will create a ridgeline relative density plot of a selected internode microtubule angles across three distinct developmental stages

library(ggridges)
library(ggplot2)
library(rcartocolor)
library(dplyr)

data <- read.csv(...) #insert dataset here

data <-na.omit(data)
data$Angle[data$Angle < 0] <- (data$Angle[data$Angle < 0]) + 180 #Transform data 

data$Stage <- factor(data$Stage,levels = c("S5", "S3", "S2"))

data$Cell_Type = "Internode 6" #This is just for aesthetics to get a facet_wrapped-esque title

ggplot(data, aes(x = Angle, y = Stage, fill = factor(stat(quantile)))) +
  stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = TRUE, quantiles = 4, quantile_lines = TRUE)+ #quartile lines will be highlighted
  scale_x_continuous(limits=c(0, 180), breaks = seq (0, 180, by = 10))+
  scale_fill_manual(values = c("#EDF8FBAD", "#B3CDE3AD", "#8C96C6AD", "#88419DAD"), labels = c("Q1 (0-25%)", "Q2 (25-50%)", "Q3 (50-75%)", "Q4 (75-100%)"), name = "Quartiles") + #adding AD after the hexcode translated to XX% opacity of the color # Custom labels for quartiles created using the display brewer
  
  ##Optional red lines to demark the angle boundaries between microtubule binning groups
  #geom_vline(xintercept = 22.5, linetype="dashed", color = "red", size=1, alpha=.7)+ 
  #geom_vline(xintercept = 67.5, linetype="dashed", color = "red", size=1, alpha=.7)+
  #geom_vline(xintercept = 112.5, linetype="dashed", color = "red", size=1, alpha=.7)+
  #geom_vline(xintercept = 157.5, linetype="dashed", color = "red", size=1, alpha=.7)+
 
  geom_point(data = data, aes(x = Angle, y = Stage), position=position_jitter(height = .05), color = "black", alpha = 0.2, size =2.5, inherit.aes = FALSE)+ #visualize individual data points
  facet_wrap(~Cell_Type)+ #used to achieve the facet-wrap title aesthetic
  theme_classic()+
  theme(text = element_text(size=20), plot.title=element_text( hjust=.5, vjust=0.5, face='bold')) #used to adjust font size of the graph

#brewer was used to obtain hex code that correlates with color palettes
display.brewer.pal(4, "BuPu")
brewer.pal(4, "BuPu")
